<mah:MetroWindow x:Class="DeviantartDownloader.Views.GetGalleryView"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:local="clr-namespace:DeviantartDownloader.Views" xmlns:viewmodels="clr-namespace:DeviantartDownloader.ViewModels" d:DataContext="{d:DesignInstance Type=viewmodels:GetGalleryViewModel}"
                 xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
                 xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                 xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
                 mc:Ignorable="d"
                 Background="#d4dfd0" WindowStartupLocation="CenterScreen" WindowTitleBrush="#06070d"
                 BorderBrush="Black" ShowIconOnTitleBar="False"
                 Title="Search Gallery" MinHeight="800" MinWidth="1000"
                 Dialog:DialogParticipation.Register="{Binding}" Loaded="MetroWindow_Loaded">
    <mah:MetroWindow.Resources>
        <CollectionViewSource x:Key="deviantViewItems" Source="{Binding Deviants}"/>
    </mah:MetroWindow.Resources>
    <Grid RowDefinitions="100,120,60,*,50">
        <Grid VerticalAlignment="Top" 
              Grid.Row="0" 
              Margin="20,10,10,10"
              ColumnDefinitions="*,100">
            <StackPanel Grid.Column="0">
                <Label Content="Search from username:"
                       Target="{Binding ElementName=textUsername}" />
                <TextBox mah:ControlsHelper.FocusBorderBrush="#93a98f"
                         mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                         mah:ControlsHelper.CornerRadius="4"
                         Name="textUsername" Background="#e9f0e6"
                         Foreground="#337287" FontWeight="SemiBold"
                         BorderBrush="#93a98f"
                         Height="35" FontSize="18"
                         Text="{Binding SearchUserName,UpdateSourceTrigger=PropertyChanged}"
                         Margin="20,0,20,0">
                    <TextBox.InputBindings>
                        <KeyBinding Command="{Binding Path=GetFolderCommand}" Key="Enter" />
                    </TextBox.InputBindings>
                </TextBox>
            </StackPanel>
            <Button Grid.Column="1" 
                    mah:ControlsHelper.CornerRadius="2"
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    Command="{Binding GetFolderCommand}"
                    BorderBrush="#93a98f" BorderThickness="2"
                    Cursor="Hand"  
                    Height="35" VerticalAlignment="Bottom">
                <StackPanel Orientation="Horizontal">
                    <TextBlock  Text="{Binding SearchFolderLabel}" 
                                Foreground="#337287"
                                Margin="0,0,8,0" 
                                VerticalAlignment="Center" />
                    <iconPacks:PackIconFontAwesome Foreground="#337287" 
                                                   Kind="MagnifyingGlassSolid" 
                                                   VerticalAlignment="Center" /> 
                </StackPanel>
            </Button>
        </Grid>
        <StackPanel Grid.Row="1" 
                    Margin="20,0,20,0">
            <Label Content="User folder" 
                   Target="{Binding ElementName=cbFolder}" />
            <Grid  Margin="20,0,20,10"
                   ColumnDefinitions="120,*,100">
                <TextBlock Grid.Column="0" 
                           VerticalAlignment="Bottom"
                           Margin="0,0,10,0"
                           FontSize="16"
                           Text="Selected user: "/>
                <TextBlock Grid.Column="1"
                           Margin="10,0,0,0"
                           FontSize="26"
                           FontWeight="DemiBold"
                           Foreground="{Binding TileBrush}"
                           Text="{Binding SelectedUsername}"/>
                <Button Grid.Column="2"
                        Cursor="Hand"
                        BorderBrush="#93a98f"
                        BorderThickness="2"
                        Command="{Binding ResetUserCommand ,UpdateSourceTrigger=PropertyChanged}" >
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Reset" 
                                   Foreground="Red"
                                   Margin="0,0,8,0" 
                                   VerticalAlignment="Center"/>       
                        <iconPacks:PackIconFontAwesome Foreground="Red" 
                                                       Kind="CircleMinusSolid" 
                                                       VerticalAlignment="Center" />
                    </StackPanel>
                </Button>
            </Grid>
            <ComboBox mah:TextBoxHelper.Watermark="Empty"
                      mah:ControlsHelper.CornerRadius="4"
                      Foreground="#337287"
                      ItemsSource="{Binding SearchResultFolders}"
                      SelectedItem="{Binding SelectedFolder,Mode=TwoWay}"                
                      IsEnabled="{Binding IsComboBoxEnabled}"
                      DisplayMemberPath="DisplayName"
                      FontSize="16"
                      BorderBrush="#93a98f"
                      SelectedValuePath="Id"
                      Margin="20,0,20,0"
                      Cursor="Hand" FontWeight="SemiBold"
                      Background="#e9f0e6"
                      IsSynchronizedWithCurrentItem="True"
                      Name="cbFolder"/>
        </StackPanel>
        <Grid Grid.Row="2">
            <Button mah:ControlsHelper.CornerRadius="2"
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    Style="{StaticResource MahApps.Styles.Button.Square.Accent}"
                    Command="{Binding GetDeviantCommand}"
                    Content="{Binding SearchDeviantLabel,Mode=TwoWay }"
                    BorderBrush="#93a98f" BorderThickness="2"
                    FontSize="16" Cursor="Hand"
                    Name="Btn_AddList"  Margin="40,10,40,10"/>
        </Grid>
        <Grid Grid.Row="3"
              ColumnDefinitions="150,*">
            <StackPanel Grid.Column="0" 
                        Margin="10,20,0,20">
                <Button
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    Command="{Binding SelectAllArtCommand}"
                    BorderBrush="#93a98f"
                    Foreground="#337287" Cursor="Hand"
                    Margin="0,0,0,20" Height="30"
                    Content="Select all art"/>
                <Button 
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    Command="{Binding SelectAllLiteratureCommand}"
                    BorderBrush="#93a98f"
                    Foreground="#337287" Cursor="Hand"
                    Margin="0,0,0,20" Height="30"
                    Content="Select all literature"/>
                <Button
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    Command="{Binding SelectAllVideoCommand}"
                    BorderBrush="#93a98f"
                    Cursor="Hand" Foreground="#337287"
                    Margin="0,0,0,20" Height="30"
                    Content="Select all video"/>
                <Button
                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                    mah:ControlsHelper.FocusBorderBrush="#93a98f"
                    mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                    BorderBrush="#93a98f"
                    Command="{Binding ClearListCommand}"
                    Background="#e18d43" Foreground="Black"
                    Cursor="Hand" Margin="0,0,0,20" 
                    Content="Clear"/> 
            </StackPanel>
            <Grid Grid.Column="1" 
                  Margin="20,20,20,20">
                <mah:Badged BadgePlacementMode="TopLeft" 
                            Badge="{Binding Deviants.Count}">
                    <DataGrid   ItemsSource="{Binding Deviants}" 
                                Background="#e9f0e6" BorderBrush="#93a98f"
                                BorderThickness="1"
                                RowBackground="#e9f0e6" Margin="0,0,0,0" 
                                CanUserAddRows="False" ColumnHeaderHeight="40" RowHeight="40" 
                                AutoGenerateColumns="False" SelectionMode="Single" 
                                SelectionUnit="Cell" CanUserResizeRows="False">
                        <DataGrid.ColumnHeaderStyle>
                            <Style  BasedOn="{StaticResource MahApps.Styles.DataGridColumnHeader}" 
                                    TargetType="{x:Type DataGridColumnHeader}">
                                <Setter Property="mah:ControlsHelper.ContentCharacterCasing" 
                                        Value="Normal" />
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="50">
                                <DataGridTemplateColumn.HeaderTemplate>
                                    <DataTemplate >
                                        <CheckBox   Margin="5,0,0,0"
                                                    Cursor="Hand"                                            
                                                    IsChecked="{Binding DataContext.IsSelectAll, 
                                                                RelativeSource={RelativeSource AncestorType={x:Type DataGrid}, 
                                                                Mode=FindAncestor}}" 
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.HeaderTemplate>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox   Margin="5,0,0,0"
                                                    Cursor="Hand"
                                                    IsChecked="{Binding IsSelected, 
                                                                Mode=TwoWay, 
                                                                UpdateSourceTrigger=PropertyChanged}" 
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Author"
                                                Binding="{Binding Author.Username}"
                                                IsReadOnly="True"
                                                Foreground="Black" Width="150" />
                            <DataGridTextColumn Binding="{Binding Title}" 
                                                Header="Deviation Name" 
                                                IsReadOnly="True"  
                                                Foreground="Black" Width="*" />
                            <DataGridTextColumn Binding="{Binding Type}" 
                                                Header="Type" 
                                                IsReadOnly="True" 
                                                Foreground="Black"  Width="60" />
                            <DataGridTextColumn Header="Date" 
                                                Binding="{Binding PublishDate,StringFormat='d'}"  
                                                IsReadOnly="True"
                                                Foreground="Black" Width="80" />
                            <DataGridTemplateColumn Header="" 
                                                    CanUserSort="False" 
                                                    Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Margin="5,0,5,0" Cursor="Hand" Foreground="#337287"  
                                                Command="{  Binding Path=DataContext.RemoveDeviantFromListCommand,       
                                                            RelativeSource= {RelativeSource FindAncestor,
                                                            AncestorType={x:Type DataGrid}}}" 
                                                CommandParameter="{Binding Path=Id}"  
                                                Content="Remove"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </mah:Badged>
            </Grid>
        </Grid>
        <Button Grid.Row="5" 
                mah:ControlsHelper.ContentCharacterCasing="Upper"
                mah:ControlsHelper.FocusBorderBrush="#93a98f"
                mah:ControlsHelper.MouseOverBorderBrush="#93a98f"
                Command="{Binding SubmitToDownloadListCommand}"
                Background="#00c787" Cursor="Hand"
                BorderBrush="#2b3635" Name="Btn_Submit" Margin="10,0,10,10"
                BorderThickness="2" FontSize="18">
            <StackPanel Orientation="Horizontal">
                <TextBlock  Text="Add to download list" 
                            Margin="0,0,8,0" 
                            VerticalAlignment="Center"/>
                <iconPacks:PackIconFontAwesome  Kind="PlusSolid" 
                                                VerticalAlignment="Center"/>
            </StackPanel>
        </Button>
    </Grid>
</mah:MetroWindow>
